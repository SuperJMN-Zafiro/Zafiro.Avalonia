<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="clr-namespace:Zafiro.UI;assembly=Zafiro.UI"
        xmlns:shell="clr-namespace:Zafiro.UI.Shell;assembly=Zafiro.UI"
        xmlns:nav="clr-namespace:Zafiro.Avalonia.Controls.Navigation">

    <Design.PreviewWith>
        <ShellView Width="700" Height="900">
            <ShellView.Shell>
                <ShellDesign />
            </ShellView.Shell>
        </ShellView>
    </Design.PreviewWith>

    <Styles.Resources>
        <DataTemplate x:Key="DesktopTemplate" DataType="shell:IShell">
            <ShellSplitView x:Name="ShellSplitView"
                            ToggleButtonTheme="{Binding $parent[ShellView].ToggleButtonTheme}"
                            PageTransition="{Binding $parent[ShellView].PageTransition}"
                            IsPaneOpen="{Binding $parent[ShellView].IsPaneOpen, Mode=TwoWay}"
                            OpenPaneLength="{Binding $parent[ShellView].OpenPaneLength}"
                            PaneHeader="{Binding Header}"
                            ContentHeader="{Binding ContentHeader^}"
                            ContentHeaderTemplate="{Binding $parent[ShellView].HeaderContentTemplate}"
                            PaneBackground="{Binding $parent[ShellView].PaneBackground}"
                            ExpandButtonSize="{Binding $parent[ShellView].MenuButtonSize}">
                <ShellSplitView.Content>
                    <nav:Frame Navigator="{Binding Navigator}" />
                </ShellSplitView.Content>
                <ShellSplitView.Styles>
                    <ContainerQuery Name="RootPanel" Query="min-width:0">
                        <Style Selector="ShellSplitView">
                            <Setter Property="DisplayMode" Value="Overlay" />
                        </Style>
                    </ContainerQuery>
                    <ContainerQuery Name="RootPanel" Query="min-width:600">
                        <Style Selector="ShellSplitView">
                            <Setter Property="DisplayMode" Value="CompactOverlay" />
                        </Style>
                    </ContainerQuery>
                    <ContainerQuery Name="RootPanel" Query="min-width:800">
                        <Style Selector="ShellSplitView">
                            <Setter Property="DisplayMode" Value="CompactInline" />
                        </Style>
                    </ContainerQuery>
                </ShellSplitView.Styles>
                <ShellSplitView.PaneContent>
                    <Sidebar
                        IconMargin="12"
                        IconWidth="{Binding $parent[ShellView].MenuButtonSize}"
                        IconTemplate="{Binding $parent[ShellView].IconTemplate}"
                        IconHeight="{Binding $parent[ShellView].MenuButtonSize}"
                        SelectedSection="{Binding $parent[ShellView].Shell.SelectedSection}"
                        Sections="{Binding Sections}">
                        <Sidebar.Transitions>
                            <Transitions>
                                <DoubleTransition Property="SectionSpacing" Duration="0:0:0.1" />
                            </Transitions>
                        </Sidebar.Transitions>
                        <Interaction.Behaviors>
                            <PointerReleasedTrigger EventRoutingStrategy="Tunnel">
                                <SetAvaloniaPropertyCurrentValueAction IsEnabled="{Binding $parent[ShellSplitView].DisplayMode, Converter={x:Static ShellConverters.IsOverlay}}"
                                                                       TargetObject="{Binding $parent[ShellView]}"
                                                                       Value="False"
                                                                       TargetProperty="{x:Static ShellView.IsPaneOpenProperty}" />
                            </PointerReleasedTrigger>
                        </Interaction.Behaviors>
                    </Sidebar>

                </ShellSplitView.PaneContent>
            </ShellSplitView>
        </DataTemplate>

        <DataTemplate x:Key="MobileTemplate" DataType="shell:IShell">
            <DockPanel>
                <ContentControl DockPanel.Dock="Top"
                                Content="{Binding ContentHeader^}"
                                ContentTemplate="{Binding $parent[ShellView].HeaderContentTemplate}" />
                <ActionBar Sections="{Binding Sections}"
                           IconTemplate="{Binding $parent[ShellView].IconTemplate}"
                           Columns="{Binding $parent[ShellView].MobileColumns}"
                           SelectedSection="{Binding SelectedSection}" DockPanel.Dock="Bottom" />
                <nav:Frame Navigator="{Binding Navigator}" />
            </DockPanel>
        </DataTemplate>

        <DataTemplate x:Key="HeaderContentTemplate">
            <ContentControl
                TextElement.FontWeight="Bold"
                TextElement.FontSize="18"
                TextBlock.TextTrimming="CharacterEllipsis" Content="{Binding}" VerticalAlignment="Center" HorizontalAlignment="Center" />
        </DataTemplate>

        <ControlTheme x:Key="{x:Type ShellView}" TargetType="ShellView">
            <Setter Property="PaneBackground" Value="{DynamicResource SystemControlPageBackgroundChromeLowBrush}" />
            <Setter Property="MenuButtonSize" Value="48" />
            <Setter Property="OpenPaneLength" Value="250" />
            <Setter Property="ToggleButtonTheme" Value="{StaticResource HamburguerMenuToggleButton}" />
            <Setter Property="IconTemplate">
                <DataTemplate DataType="ui:IIcon">
                    <Viewbox>
                        <ContentControl ContentTemplate="{StaticResource IconDataTemplate}" Content="{Binding }" />
                    </Viewbox>
                </DataTemplate>
            </Setter>
            <Setter Property="IsPaneOpen" Value="True" />
            <Setter Property="MobileColumns" Value="4" />
            <Setter Property="HeaderContentTemplate" Value="{StaticResource HeaderContentTemplate}" />
            <Setter Property="PageTransition">
                <CrossFade Duration="0:00:00.2" />
            </Setter>
            <Setter Property="Template">
                <ControlTemplate>
                    <Panel Container.Name="RootPanel" Container.Sizing="WidthAndHeight">
                        <ContentControl x:Name="Content" Content="{TemplateBinding Shell}" ContentTemplate="{StaticResource DesktopTemplate}" />
                    </Panel>
                </ControlTemplate>
            </Setter>
            <ContainerQuery Name="RootPanel" Query="min-width:0">
                <Style Selector="ContentControl#Content">
                    <Setter Property="ContentTemplate" Value="{StaticResource MobileTemplate}" />
                </Style>
            </ContainerQuery>
            <ContainerQuery Name="RootPanel" Query="min-width:450">
                <Style Selector="ContentControl#Content">
                    <Setter Property="ContentTemplate" Value="{StaticResource DesktopTemplate}" />
                </Style>
            </ContainerQuery>
        </ControlTheme>
    </Styles.Resources>

</Styles>